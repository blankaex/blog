---
layout: post
title:  "死神のミッション第１弾"
date: 2021-07-12
excerpt: "新すばらしきこのせかいWEB謎解き。"
tag:
- CTF
- 日本語
---

# 死神のミッション １日目

{% capture images %}
    {{ site.url }}/assets/res/2021-07-12-reapers-game/mission_img_1.webp
{% endcapture %}
{% include gallery images=images %}

<details><summary>ヒント▶</summary>
    {% capture images %}
        {{ site.url }}/assets/res/2021-07-12-reapers-game/hint_1.jpg
    {% endcapture %}
    {% include gallery images=images %}
</details>

<details><summary>解説▶</summary>
    {% capture images %}
        {{ site.url }}/assets/res/2021-07-12-reapers-game/hint_1_5.jpg
    {% endcapture %}
    {% include gallery images=images %}

    {% capture images %}
        {{ site.url }}/assets/res/2021-07-12-reapers-game/answer_1.jpg
    {% endcapture %}
    {% include gallery images=images %}

    答えは「カンゲイ」（ショック→カンゲイ）。
</details>

# 死神のミッション ２日目

{% capture images %}
    {{ site.url }}/assets/res/2021-07-12-reapers-game/mission_img_2.webp
{% endcapture %}
{% include gallery images=images %}

<details><summary>ヒント▶</summary>
    {% capture images %}
        {{ site.url }}/assets/res/2021-07-12-reapers-game/hint_2.jpg
    {% endcapture %}
    {% include gallery images=images %}
</details>

<details><summary>解説▶</summary>
    {% capture images %}
        {{ site.url }}/assets/res/2021-07-12-reapers-game/hint_2_5.jpg
    {% endcapture %}
    {% include gallery images=images %}

    {% capture images %}
        {{ site.url }}/assets/res/2021-07-12-reapers-game/answer_2.jpg
    {% endcapture %}
    {% include gallery images=images %}

    答えは「スパーク」。
</details>

# 死神のミッション ３日目

{% capture images %}
    {{ site.url }}/assets/res/2021-07-12-reapers-game/mission_img_3.webp
{% endcapture %}
{% include gallery images=images %}

<details><summary>ヒント▶</summary>
    {% capture images %}
        {{ site.url }}/assets/res/2021-07-12-reapers-game/hint_3.jpg
    {% endcapture %}
    {% include gallery images=images %}
</details>

<details><summary>解説▶</summary>
    {% capture images %}
        {{ site.url }}/assets/res/2021-07-12-reapers-game/hint_3_5.jpg
    {% endcapture %}
    {% include gallery images=images %}

    {% capture images %}
        {{ site.url }}/assets/res/2021-07-12-reapers-game/answer_3.jpg
    {% endcapture %}
    {% include gallery images=images %}

    答えは「カンムリ」。
</details>

# 死神のミッション ４日目

{% capture images %}
    {{ site.url }}/assets/res/2021-07-12-reapers-game/mission_img_4.webp
{% endcapture %}
{% include gallery images=images %}

<details><summary>ヒント▶</summary>
    {% capture images %}
        {{ site.url }}/assets/res/2021-07-12-reapers-game/hint_4.jpg
    {% endcapture %}
    {% include gallery images=images %}
</details>

<details><summary>解説▶</summary>
    {% capture images %}
        {{ site.url }}/assets/res/2021-07-12-reapers-game/hint_4_5.jpg
    {% endcapture %}
    {% include gallery images=images %}

    {% capture images %}
        {{ site.url }}/assets/res/2021-07-12-reapers-game/answer_4.jpg
    {% endcapture %}
    {% include gallery images=images %}

    答えは「ネクスト」（NEXT→ネクスト）。
</details>

# 死神のミッション ５日目

{% capture images %}
    {{ site.url }}/assets/res/2021-07-12-reapers-game/mission_img_5.webp
{% endcapture %}
{% include gallery images=images %}

<details><summary>ヒント▶</summary>
    {% capture images %}
        {{ site.url }}/assets/res/2021-07-12-reapers-game/hint_5.jpg
    {% endcapture %}
    {% include gallery images=images %}
</details>

<details><summary>解説▶</summary>
    {% capture images %}
        {{ site.url }}/assets/res/2021-07-12-reapers-game/answer_5.jpg
    {% endcapture %}
    {% include gallery images=images %}

    答えは「マスター」。
</details>

# 死神のミッション ６日目

{% capture images %}
    {{ site.url }}/assets/res/2021-07-12-reapers-game/mission_img_6.webp
{% endcapture %}
{% include gallery images=images %}

<details><summary>ヒント▶</summary>
    {% capture images %}
        {{ site.url }}/assets/res/2021-07-12-reapers-game/hint_6.jpg
    {% endcapture %}
    {% include gallery images=images %}
</details>

<details><summary>解説▶</summary>
    答えは「リスタート」。理由はわからん。<a href="{{ site.url }}/reapers-game/#おまけ"><b>おまけ</b></a>をチェックして。
</details>

# 死神のミッション ７日目

{% capture images %}
    {{ site.url }}/assets/res/2021-07-12-reapers-game/mission_img_7.webp
{% endcapture %}
{% include gallery images=images %}

<details><summary>ヒント▶</summary>
    {% capture images %}
        {{ site.url }}/assets/res/2021-07-12-reapers-game/hint_7.jpg
    {% endcapture %}
    {% include gallery images=images %}
</details>

<details><summary>解説▶</summary>
    {% capture images %}
        {{ site.url }}/assets/res/2021-07-12-reapers-game/hint_7_5.jpg
    {% endcapture %}
    {% include gallery images=images %}
    答えは「あいことば」。
</details>

# 死神のミッション Final Mission

{% capture images %}
    {{ site.url }}/assets/res/2021-07-12-reapers-game/mission_img_8.webp
{% endcapture %}
{% include gallery images=images %}

<details><summary>ヒント▶</summary>
    {% capture images %}
        {{ site.url }}/assets/res/2021-07-12-reapers-game/hint_8.jpg
    {% endcapture %}
    {% include gallery images=images %}
</details>

<details><summary>解説▶</summary>
    答えは「ゲームスタート」。
</details>

# おまけ

６日目のミッションがあまりにも意味不明過ぎて、CTFの能力に頼る羽目になった。日本人の開発者は無能だと世界中で言われていたのでちょっぴり期待してた。ソースに目を通したところ、案の定目立った部分があった。

```
<script>
(function()
{
let date = new Date().getTime();
window.quizDataPath = "../../js/mission.json?" + date;
})();
</script>
```

`../../js/mission.json`のところはいわばパストラバーサルの証で、サーバーの他のディレクトリにファイルがあると証明している。

```
https://www.jp.square-enix.com/shinsubarashiki/shibuya/mission/special/
→ https://www.jp.square-enix.com/shinsubarashiki/shibuya/mission/special/../../js/mission.json
→ https://www.jp.square-enix.com/shinsubarashiki/shibuya/js/mission.json
```

そのパスを確認するとなんと…

```
{
  "data": [
    {
      "num": 1,
      "answer": "e382abe383b3e382b2e382a4",
      "hint": {
        "txt": "104の前にいたヤツが惜しいところまでたどりついていたぞ。お前の能力で心の声を見てみたらどうだ？",
        "link": "../../"
      },
      "success":"おめでとう。1日目のミッションクリアだ。<br>まだ気は抜くな。<br>死神のゲームは始まったばかりだ。",
      "share": "1日目のミッションをクリア！",
      "hash": "#死神のミッション #新すばせか",
      "shareurl": "clear.html"
    },
    ...
}
```

外部アクセス可。ファイルの中身がプレーンテキストで丸出し。しかもanswerも当たり前のように書いてある。けど何らかのアルゴリズムにハッシュ化されている模様。今までの答えと比較してみよう。

```
カンゲイ → e382abe383b3e382b2e382a4
スパーク → e382b9e38391e383bce382af
カンムリ → e382abe383b3e383a0e383aa
ネクスト → e3838de382afe382b9e38388
マスター → e3839ee382b9e382bfe383bc
？？？？ → e383aae382b9e382bfe383bce38388
```

言うまでもないけど明らかにパターンがある。ただのURLエンコードじゃん。ハッシュ化でもされていない。

```
>>> from urllib.parse import unquote
>>> str = "e382abe383b3e382b2e382a4"
>>> unquote("%"+"%".join([str[i:i+2] for i in range(0, len(str), 2)]))
'カンゲイ'
>>> str = "e383aae382b9e382bfe383bce38388"
>>> unquote("%"+"%".join([str[i:i+2] for i in range(0, len(str), 2)]))
'リスタート'
```

呆れたｗ

明日のミッション楽しみにしてるよ！

<style>
    details
    {
        background-color: #c7c7c7;
        padding: 5px 10px 5px 10px;
        margin: 10px 0px 10px 0px;
        border-radius: 5px;
    }

    summary:hover
    {
        color: #b35959;
    }
</style>
